@model TradingApp.Models.ViewModal.CompaniesStocks

@{
    ViewData["Title"] = "Home";
}
<div class="alert-info alert-dismissable">@ViewData["message"]</div>
<div class="container-fluid">
    <div id="home_chart" class="col-md-8">
        <!--Stock chart-->
        <br />
        <canvas id="homeChart" height="500" width="880"></canvas>
        <a asp-controller="Home" asp-action="SaveCharts" asp-route-symbol="@Model.Current.symbol">Save Chart</a>
</div>
    <div id="chart_options" class="col-md-2">
        <select id="chart_range" style="width:100%; margin:10px" onchange='changeChart("@ViewData["Symbol"]")'>
            <!-- Date Range of stocks for chart -->
            @*<option value="dynamic">Dynamic</option>*@
            <option value="1d">1 Day</option>
            <option value="1m">1 Month</option>
            <option value="3m">3 Months</option>
            <option value="6m">6 Months</option>
            <option value="ytd">Year to date</option>
            <option value="1y">1 Year</option>
            <option value="2y">2 Years</option>
            <option value="5y">5 Years</option>
            <option value="">All</option>
        </select>
        @*<select id="chart_properties" style="width:100%; margin:10px" size="5" multiple>*@
            <!--Stock properties to show on chart
    Price, Open, Close(default), High, Low, Volume(default)-->
            @*<option value="open">Open</option>
            <option value="high">High</option>
            <option value="low">Low</option>
            <option value="close" selected>Close</option>
            <option value="volume" selected>Volume</option>
            <option value="change">Change</option>
            <option value="changePercent">Percentage Change</option>
            <option value="changeOverTime">Change Over Time</option>
        </select>*@
        <table class="table">
            <!-- Stock Information -->
            <tr>
                <td>Company Symbol: </td>
                <td>@Model.Current.symbol</td>
            </tr>
            <tr>
                <td>Low: </td>
                <td>@Model.Current.low</td>
            </tr>
            <tr>
                <td>High: </td>
                <td>@Model.Current.high</td>
            </tr>
            <tr>
                <td>Open: </td>
                <td>@Model.Current.open</td>
            </tr>
            <tr>
                <td>Close: </td>
                <td>@Model.Current.close</td>
            </tr>
            <tr>
                <td>Change: </td>
                <td>@Model.Current.change</td>
            </tr>
        </table>
    </div>
    <div id="live" class="col-md-2">
        <button class="btn btn-danger" onclick="refresh()">Refresh Companies</button>
        <div id="userOnly">
            <label>
                Recommended Top 5 to buy
            </label>
            <ul class="list-group">
                @foreach (var top in Model.Top5)
                {
                    <li class="list-group-item"> @top.Symbol - @top.Name</li>
                }
            </ul>
            <label>
                Recommended Top 5 to sell
            </label>
            <ul class="list-group">
                @foreach (var bottom in Model.Bottom5)
                {
                    <li class="list-group-item"> @bottom.Symbol - @bottom.Name</li>
                }
            </ul>
        </div>
        
        <div style="height:80vh; overflow:auto">
            <label>
                All stocks
            </label>
            <div class="list-group" size="10">
                @foreach (var company in Model.Companies)
                {
                    <button type="button" class="list-group-item" onclick='changeChart("@company.symbol")'> @company.symbol - @company.name</button>
                }
            </div>
        </div>
        
    </div>
</div>
<script>
    //createChart(id, xlabels, ylabels, ydatas, cdataavgs)
    createChart("homeChart", ["@Model.Dates"], ["Prices", "Volumes"], ["@Model.Prices", "@Model.Volumes"], [@Model.AvgPrice, @Model.AvgVolume]);
    function refresh() {
        if (window.confirm("Refreshing can take several minutes. Do you want to continue?")) {
            location.href = "/Home/saveCompanies";
        }
    }
</script>
<script src="~/js/JavaScript.js"></script>